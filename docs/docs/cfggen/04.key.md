---
layout: page
title: ä¸»é”®ã€æšä¸¾ã€å¤–é”®
parent: é…è¡¨ç³»ç»Ÿ
nav_order: 4
---

# ğŸ”‘ ä¸»é”®ã€æšä¸¾ã€å¤–é”®
{: .no_toc }

## Table of contents
{: .no_toc .text-delta }

- TOC
{:toc}
---


```
ä¸»é”®ã€å”¯ä¸€é”®ã€æšä¸¾ã€å…¥å£éƒ½æ˜¯è®¿é—®è¡¨ä¸­ä¸€è¡Œæ•°æ®çš„æ–¹å¼ã€‚
å¤–é”®åˆ™æŠŠæ•°æ®è¿æˆç½‘ç»œã€‚
```

---

## ğŸ”‘ ä¸»é”®

æ¯ä¸ªtableå¿…é¡»æœ‰ä¸»é”®ï¼Œé€»è¾‘ä»£ç é€šè¿‡ä¸»é”®æ‹¿åˆ°å¯¹åº”çš„tableä¸­å…·ä½“è¡Œã€‚

ä¸»é”®å¯ä»¥åˆ†ä¸ºä»¥ä¸‹æƒ…å†µï¼š

- ç®€å•ä¸»é”®

    ```
    table task[taskid] {
        taskid:int;
        text:text;
    }
    ```

    ç»å¤§å¤šæ•°tableåº”è¯¥éƒ½æ˜¯ç®€å•ä¸»é”®ï¼Œç±»å‹ä¸ºintï¼Œlongï¼Œstr

- å¤åˆç»“æ„åšä¸ºä¸»é”®

    ```
    struct LevelRank {
        level:int;
        rank:int;
    }

    table jewelryrandom[lvlRank] {
        lvlRank:LevelRank;
        attack:int;
    }
    ```

    lvlRankä½œä¸ºä¸€ä¸ªå¤åˆç»“æ„å¯ä»¥ä½œä¸ºä¸»é”®ã€‚

    - ä½†åœ¨ç°åœ¨çš„ç”Ÿæˆluaä»£ç ä¸­ï¼Œæ˜¯ä»¥å¼•ç”¨ï¼ˆå†…å­˜åœ°å€ï¼‰è€Œéå†…å®¹æ¯”è¾ƒçš„ï¼Œéœ€è¦ç”Ÿæˆluaçš„è¯ä¸è¦ç”¨å®ƒ

- å¤šä¸ªfieldä½œä¸ºä¸»é”®

    ```
    table jewelryrandom[level,rank] {
        level:int;
        rank:int;
        attack:int;
    }
    ```

    level,rankä¸¤åˆ—åšä¸ºä¸»é”®

    - åœ¨luaä¸­,2ä¸ªéƒ½æ˜¯æ•°å­—çš„è¯æ˜¯å¯ä»¥çš„ï¼Œåªè¦ä¿è¯ç¬¬ä¸€ä¸ª<1äº¿ï¼Œç¬¬äºŒä¸ª<1ä¸‡ã€‚åº•å±‚ä»¥`k + j * 100000000`ä¸ºkey


## ğŸ” å”¯ä¸€é”®

å½“é€»è¾‘ä»£ç å¸Œæœ›ä»¥å¤šä¸ªä¸åŒçš„æ–¹å¼æ‰¾åˆ°åˆ°åŒä¸€è¡Œæ—¶ï¼Œè¦é€‰æ‹©ä¸€ä¸ªæ–¹å¼ä¸ºä¸»é”®ï¼Œå…¶ä»–æ–¹å¼ä¸ºå”¯ä¸€é”®

- å”¯ä¸€é”®è¦æ”¾åˆ°fieldå®šä¹‰çš„å‰é¢ï¼Œä»¥`[`å¼€å§‹ã€`]`ç»“æŸ

```
table task[taskid] {
    [nexttask];
	taskid:int; // ä»»åŠ¡id
	text:text;
	nexttask:int;
	rewardItems:list<RewardItem> (block=1); // ç‰©å“å¥–åŠ±
}
```

tableä¸­ä¸€è¡Œä»¥`[`å¼€å§‹ï¼Œåˆ™è¡¨ç¤ºæ˜¯åœ¨å®šä¹‰å”¯ä¸€é”®ï¼Œ

ä»¥ä¸Šnexttaskä¸ºå”¯ä¸€é”®ï¼Œéœ€è¦å®šä¹‰å”¯ä¸€é”®çš„æƒ…å†µåº”è¯¥å¾ˆå°‘ã€‚

## ğŸ“‹ æšä¸¾ã€å…¥å£

ä¸ºäº†ä¸åœ¨ä»£ç ä¸­ç•™ä¸‹å¾ˆå¤šé…è¡¨çš„ä¸»é”®çš„`é­”æ•°`ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨é…è¡¨ä¸­å¼•å…¥ç¨‹åºç”¨çš„ä¸€åˆ—ï¼Œé‡Œé¢æ˜¯ç¨‹åºè‹±æ–‡åï¼Œä¼šç”Ÿæˆåˆ°ä»£ç é‡Œã€‚

- æšä¸¾

    ```
    table itemtype[id] (enum='type'){
        id:int;
        type:str;
    }
    ```

    ä»¥ä¸Š`enum='type'`ï¼Œå®Œæˆå¯¹æšä¸¾çš„å£°æ˜ï¼Œtypeè¿™ä¸€åˆ—é‡Œå°†éƒ½æ˜¯è‹±æ–‡åç§°ï¼Œä¸èƒ½é‡å¤ï¼Œä¸èƒ½ä¸ºç©ºï¼Œç”±ç¨‹åºå¡«å†™

- å…¥å£

    ```
    table scene[id] (entry='entry') {
        id:int;
        entry:str;
        info:text;
    }
    ```

  ä»¥ä¸Š`entry='entry'`å®Œæˆå¯¹å…¥å£çš„å£°æ˜ï¼Œentryè¿™ä¸€åˆ—ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯ç©ºï¼Œä½†æœ‰å‡ è¡Œï¼Œåº”è¯¥æ˜¯è‹±æ–‡åç§°ï¼Œç”±ç¨‹åºå¡«å†™ã€‚


## ğŸ”— å¤–é”®

- ç´¢å¼•åˆ°ä¸»é”®

    ```
    struct RewardItem {
        chance:int; // æ‰è½æ¦‚ç‡
        itemids:list<int> ->item.item; // æ‰è½ç‰©å“
        range:Range; // æ•°é‡ä¸‹é™
    }
    ```

    ä»¥ä¸Š`->item.item`å®Œæˆå¯¹`list<int>`æ¯ä¸ªintçš„å¤–é”®å£°æ˜

- ç´¢å¼•åˆ°å”¯ä¸€é”®

    ```
    struct AA {
        taskid:int ->task[nexttask];
    }
    ```

    ä»¥ä¸Š`->task[nexttask]`,è¡¨ç¤ºç´¢å¼•åˆ°taskè¡¨çš„nexttaskå”¯ä¸€é”®

- ä½¿ç”¨=>ç´¢å¼•åˆ°ä»»æ„å­—æ®µï¼ˆç”ŸæˆlistRefï¼‰

    ```
    table drop[dropid] {
        dropid:int =>dropItem[dropid];
        name:text;
    }
    ```

    ä»¥ä¸Š`=>dropItem[dropid]`ï¼Œç”¨`=>`è¡¨æ˜ä¸ä¸€å®šæŒ‡å‘tableçš„å”¯ä¸€é”®ï¼Œè€Œæ˜¯ä»»æ„å­—æ®µï¼Œç”Ÿæˆçš„ç¨‹åºä»£ç ä¼šè¿”å›`listRefDropId`ï¼Œæ˜¯ä¸ªåˆ—è¡¨ã€‚

- å•ç‹¬ä¸€è¡Œå£°æ˜

    - åœ¨fieldå…¨éƒ¨å®šä¹‰å®Œä¹‹åï¼Œå¯ä»¥å¦èµ·è¡Œå®šä¹‰å¤–é”®

    ```
    table monster[id] {
        id:int;
        lootId:int; // loot
        lootItemId:int; // item
        ->Loot:[lootId,lootItemId] ->lootitem;
        ->AllLoot:[lootId] ->loot[id];
    }
    ```

    å¦‚ä¸Š`->Loot:[lootId,lootItemId] ->lootitem`
    - `->`ï¼šè¡¨ç¤ºç°åœ¨æ˜¯å¤–é”®å®šä¹‰
    - `Loot`æ˜¯æ­¤å¤–é”®çš„åç§°
    - `[lootId,lootItemId]` è¡¨ç¤ºæœ¬åœ°çš„keyç”±æ˜¯ä¸¤ä¸ªfieldç»„æˆ
    - `->lootitem` è¡¨åç´¢å¼•åˆ°`lootitem`è¡¨

    ```
    table drop[dropid] {
        dropid:int;
        name:text;
        ->AllDrops:[dropid] =>dropItem[id];
    }
    ```

    å¦‚ä¸Šä¼šç”Ÿæˆ `listRefAllDrops`ï¼Œè·Ÿå†fieldä¸Šå£°æ˜çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯è¿™ä¸ªåå­—åç¼€`AllDrops`å¯æ§ã€‚

---

**å¤–é”®ç±»å‹æ€»ç»“ï¼š**

- **`->`**ï¼šæŒ‡å‘å”¯ä¸€é”®ï¼ˆä¸»é”®æˆ–å”¯ä¸€é”®ï¼‰ï¼Œç”Ÿæˆå•ä¸ªå¼•ç”¨ï¼ˆ`refXxx`ï¼‰
- **`=>`**ï¼šæŒ‡å‘ä»»æ„å­—æ®µï¼Œç”Ÿæˆåˆ—è¡¨å¼•ç”¨ï¼ˆ`listRefXxx`ï¼‰

## nullable

```
table task[taskid] (entry='entry') {
	taskid:int ->task.taskextraexp (nullable); // ä»»åŠ¡id
	entry:str;
	text:text;
	nexttask:int ->task (nullable);
}
```

- å¯ä»¥åœ¨é…ç½®äº†refçš„fieldä¸ŠåŠ nullableï¼Œè¡¨ç¤ºå¯ä»¥æ‰¾ä¸åˆ°æ­¤å¤–é”®ï¼Œç”Ÿæˆä»£ç ä¼šæ˜¯nullableRefXXX
- nullableçš„fieldï¼Œå¦‚æœåœ¨excelæ ¼å­ä¸­ï¼Œåˆ™åŠ å¼ºäº†ä»¥ä¸‹çº¦æŸï¼šæ ¼å­ä¸­ä¸ºç©ºæ‰å¯ä»¥nullableï¼Œåªè¦æ ¼å­æœ‰å†…å®¹å¿…é¡»èƒ½æ‰¾åˆ°å¤–é”®ã€‚ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¾‹å¤–ï¼š
    1. fieldæ˜¯æ­¤tableä¸»é”®æˆ–å”¯ä¸€é”®çš„ä¸€éƒ¨åˆ†ã€‚`task.taskid`
    2. fieldç±»å‹æ˜¯æ•°å€¼ï¼ˆintã€longã€floatï¼‰ï¼Œä¸”å†…å®¹ä¸º0ã€‚`task.nexttask`
