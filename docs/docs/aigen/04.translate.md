---
layout: page
title: AI翻译
parent: ai生成
nav_order: 4
---

# AI翻译

配合 [国际化支持方案2](../cfggen/09.i18n2.md) 对todo文件进行AI辅助翻译。

## 📋 概述

AI翻译工具提供以下功能：
1. **术语一致性检查** - 确保翻译中的术语统一
2. **AI批量翻译** - 使用AI模型进行智能翻译
3. **翻译质量评估** - 提供翻译置信度评估

## 🎯 使用场景

- 游戏本地化翻译
- 多语言文档翻译
- 术语一致性维护
- 批量文本翻译

---

## 📚 术语一致性检查

### 1. 术语表配置

术语从todo文件的"参考用"工作表中提取，根据table和fieldChain来抽取。

**配置说明**：
需要创建一个CSV配置文件，声明要抽取哪些table和fieldChain。

**配置示例** (`term.csv`)：
```csv
item.commonitem,Name
mwequip.equipattr,Name
mwlevels.mwlevelsdifficultytype,name
```

**字段说明**：
- 第一列：`table` - 数据表名称（如 `item.commonitem`）
- 第二列：`fieldChain` - 字段链，用于定位具体字段（如 `Name`）

**示例解释**：
以 `item.commonitem,Name` 为例：
- `item.commonitem`：完整的数据表名称
- `Name`：字段链，表示从item.commonitem表中提取Name字段的值作为术语

### 2. 术语查看命令

查看从todo文件中提取的术语：

```bash
-tool term,todo:_todo_en.xlsx,term:term.csv
```

**参数说明**：
- `todo`：待翻译的Excel文件
- `term`：术语配置CSV文件

### 3. 术语匹配情况检查

#### 3.1 检查todo工作表
只检查todo工作表中的术语匹配情况：

```bash
-tool term,todo:_todo_en.xlsx,term:term.csv,check
```

#### 3.2 检查所有工作表
检查todo和"参考用"两个工作表中的术语匹配情况：

```bash
-tool term,todo:_todo_en.xlsx,term:term.csv,checkall
```

---

## 🤖 AI翻译

### 1. 基本翻译命令

使用AI进行批量翻译：

```bash
-tool translate,source:中文,target:英文,todo:_todo_en.xlsx,term:term.csv,ai:ai.json,batch:10
```

**参数说明**：

| 参数 | 说明 | 示例值 |
|------|------|--------|
| `source` | 源语言 | `中文` |
| `target` | 目标语言 | `英文` |
| `todo` | 待翻译文件 | `_todo_en.xlsx` |
| `term` | 术语配置文件 | `term.csv` |
| `ai` | AI配置 | `ai.json` |
| `batch` | 批量大小 | `10` |

### 2. 翻译流程

1. **优先匹配**：先从"参考用"工作表中找出完全相同的`original`进行复用
2. **AI翻译**：其余文本参考术语表`term`使用AI进行翻译
3. **质量评估**：AI会为每个翻译提供置信度评估

### 3. AI配置

`ai.json`的配置参考 [批量生成](02.batch.html) 文档。

### 4. 自定义提示词

#### 4.1 默认提示词

系统使用以下默认提示词模板：

`````markdown
@import configgen.geni18n.TodoTranslateModel
@param TodoTranslateModel model

# 角色：专业游戏本地化翻译专家

## 任务描述
你是一个专业的游戏本地化翻译专家，擅长将游戏文本从${model.sourceLang()}翻译成${model.targetLang()}，并保持术语一致性和上下文准确性。

## 相关术语表
以下是相关术语表（CSV格式，列：原文术语,目标语言术语）：
```
${model.relatedTermsInCsv()}
```

## 相关翻译参考
以下是从已翻译文本中查找的相似翻译参考（CSV格式，列：原文,目标语言）：
```
${model.relatedTranslationsInCsv()}
```

## 待翻译文本
以下是待翻译的原文文本（使用XML分隔符分隔）：
!{int index = 1;}
@for (var original : model.todoOriginals())
    <original_${index}>${original}</original_${index}>
    !{index++;}
@endfor

## 翻译要求
1. **准确性**：准确传达原文含义，符合游戏上下文
2. **术语一致性**：优先使用术语表中的翻译，保持术语一致性
3. **翻译参考**：参考相似翻译的译法，保持翻译风格一致性
4. **自然流畅**：翻译结果应自然、流畅，符合目标语言表达习惯
5. **文化适应性**：考虑文化差异，进行适当本地化调整

## 输出格式
请以JSON数组格式输出翻译结果，每个item是一个包含以下字段的结构：
```json
[
  {
    "original": "原文1",
    "translated": "翻译1",
    "confidence": "high/medium/low",
    "note": "备注（可选）"
  },
  {
    "original": "原文2",
    "translated": "翻译2",
    "confidence": "high/medium/low",
    "note": "备注（可选）"
  }
]
```

**注意**：
- **confidence**：表示翻译置信度，可选值：high（高置信度）、medium（中等置信度）、low（低置信度）
- **note**：可以留空，或简要说明翻译难点、歧义、上下文依赖等
- 请严格按照上述JSON格式输出，不要包含其他文本

请开始翻译并输出结果：
`````

#### 4.2 模板变量说明

| 变量 | 说明 |
|------|------|
| `${model.sourceLang()}` | 源语言（如：中文） |
| `${model.targetLang()}` | 目标语言（如：英文） |
| `${model.relatedTermsInCsv()}` | 相关术语表（CSV格式） |
| `${model.relatedTranslationsInCsv()}` | 相关翻译参考（CSV格式） |
| `${model.todoOriginals()}` | 待翻译的原文列表 |

#### 4.3 使用自定义提示词

如果要使用自定义提示词，添加`prompt`参数：

```bash
-tool translate,source:中文,target:英文,todo:_todo_en.xlsx,term:term.csv,ai:ai.json,batch:10,prompt:translate.jte
```

**自定义提示词文件** (`translate.jte`)：
- 使用JTE模板语法
- 可以引用`TodoTranslateModel`模型

---

## 🚀 快速开始

### 步骤1：准备文件
1. 准备待翻译的Excel文件：`_todo_en.xlsx`
2. 创建术语配置文件：`term.csv`
3. 配置AI参数：`ai.json`

### 步骤2：检查术语一致性

```bash
-tool term,todo:_todo_en.xlsx,term:term.csv,checkall
```

### 步骤3：执行AI翻译

```bash
-tool translate,source:中文,target:英文,todo:_todo_en.xlsx,term:term.csv,ai:ai.json,batch:10
```

### 步骤4：验证翻译结果
检查生成的翻译结果，重点关注`confidence`为`low`的条目。

---

## 💡 最佳实践

1. **术语表配置维护**
   - 定期更新术语表配置
   
2. **批量大小设置**
   - 建议批量大小：5-30条
   - 过大可能导致AI理解困难
   - 过小可能影响翻译效率

3. **翻译质量检查**
   - 重点关注低置信度翻译
   - 检查术语使用是否正确
   - 验证上下文相关性

4. **自定义提示词**
   - 根据项目需求调整提示词
   - 添加项目特定的翻译要求
   - 优化输出格式要求

---

## 📝 总结

AI翻译工具通过以下方式提高翻译效率和质量：

1. **自动化流程**：自动匹配已有翻译，减少重复工作
2. **术语一致性**：通过术语表确保翻译一致性
3. **智能翻译**：利用AI进行上下文感知翻译
4. **质量评估**：提供翻译置信度，便于人工复核

### 相关文档
- [国际化支持方案2](../cfggen/09.i18n2.md) - 了解国际化框架
- [批量生成](02.batch.html) - 配置AI参数
